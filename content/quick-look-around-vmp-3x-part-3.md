---
name: –ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä VMP 3.x ‚Äî –ß–∞—Å—Ç—å 3. –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è
description: –Ø –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é –ø–∏—Ä–∞—Ç—Å—Ç–≤–æ –Ω–∏ –≤ –∫–æ–µ–º —Å–ª—É—á–∞–µ –∏ –Ω–µ —Å–∫–∞–∂—É –∫–∞–∫ –≤–∑–ª–æ–º–∞—Ç—å VMP, –ù–û...
date: 11.12.2025
---

–ü—Ä–∏–≤–µ—Ç

–í–æ—Ç –º–æ–µ –∫—Ä–∞—Ç–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ VMP.

## 0 - ‚ö†Ô∏è –í–ê–ñ–ù–û–ï –ü–†–ò–ú–ï–ß–ê–ù–ò–ï

–≠—Ç–∞ —Å—Ç–∞—Ç—å—è –æ–±—ä—è—Å–Ω—è–µ—Ç, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç VMProtect, –∞ –Ω–µ –∫–∞–∫ –≤–∑–ª–æ–º–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ, –∑–∞—â–∏—â–µ–Ω–Ω–æ–µ VMP. –Ø –Ω–µ –≥–æ–≤–æ—Ä—é –Ω–∏ –æ –∫–∞–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã—Ö VMP, –∏–ª–∏ –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º VMP. –Ø –ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–Æ –ü–ò–†–ê–¢–°–¢–í–û –Ω–∏ –≤ –∫–æ–µ–º —Å–ª—É—á–∞–µ. –≠—Ç–∞ –∑–∞—â–∏—Ç–∞ (–≤–∑–ª–æ–º–∞–Ω–Ω–∞—è/—É—Ç–µ—Ä—è–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞—â–∏—Ç—ã –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º, –∏ –º–æ—è —Ü–µ–ª—å –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ ‚Äî —É–ª—É—á—à–∏—Ç—å –æ–±—â–µ–µ –∑–Ω–∞–Ω–∏–µ –æ –Ω–µ–π, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º. –Ø –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª —ç—Ç—É —Å—Ç–∞—Ç—å—é –¢–û–õ–¨–ö–û –í –û–ë–†–ê–ó–û–í–ê–¢–ï–õ–¨–ù–´–• –¶–ï–õ–Ø–•. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Å–æ –∑–ª—ã–º —É–º—ã—Å–ª–æ–º, –∏ –ø–æ—ç—Ç–æ–º—É —è –ù–ï –ì–ê–†–ê–ù–¢–ò–†–£–Æ –ò –ù–ï –ù–ï–°–£ –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–ò –∑–∞ —Ç–∞–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ. –í—ã –Ω–µ—Å–µ—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏.

## I - –í–≤–µ–¥–µ–Ω–∏–µ

–ü—Ä–∏–≤–µ—Ç, –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ, –∫–∞–∫ —è –≥–æ–≤–æ—Ä–∏–ª –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –Ω–∞–∑–∞–¥, –≤–æ—Ç –ß–∞—Å—Ç—å 3 –º–æ–µ–π —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ VMP. –®–∞–≥ –≤ –±–µ–∑—É–º–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏. –Ø –Ω–µ —Å–æ–±–∏—Ä–∞—é—Å—å –≥–æ–≤–æ—Ä–∏—Ç—å –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≤–µ—â–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏—è VMP, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–æ–º –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä—É—Ç–∏–Ω—ã –∏ –¥—Ä—É–≥–∏–µ –≤–µ—â–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏. –ú–æ—è –º–æ—Ç–∏–≤–∞—Ü–∏—è ‚Äî —ç—Ç–æ –≤—ã–∑–æ–≤ –ø–æ–Ω–∏–º–∞–Ω–∏—è —á–µ–≥–æ-—Ç–æ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –±–æ–ª—å—à–æ–≥–æ –∏ –ø–æ–º–æ—â—å —Ä–µ–≤–µ—Ä—Å–µ—Ä–∞–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ VMP. –ú–æ–π –∞–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ Windows x86, —è –±—É–¥—É –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä—É—Ç–∏–Ω—ã VMP –∏ –ø—Ä–∏–≤–µ–¥—É –ø—Ä–∏–º–µ—Ä, –æ–±—ä—è—Å–Ω—è—è, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–∂–Ω–æ —ç—Ç–æ –ø–æ–Ω—è—Ç—å.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –Ø –Ω–µ –∏–¥–µ–∞–ª–µ–Ω –≤ —Å–≤–æ–µ–º —Ä–µ–≤–µ—Ä—Å–µ, —è –º–æ–≥—É –æ—à–∏–±–∞—Ç—å—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —á–∞—Å—Ç—è—Ö.

## II - –î–µ–º–æ vs –ü–ª–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è

–î–µ–º–æ-–≤–µ—Ä—Å–∏—è –¥–∞–∂–µ –±–ª–∏–∑–∫–æ –Ω–µ —Å—Ç–æ–∏—Ç –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∫ –ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏. –î–µ–º–æ-–≤–µ—Ä—Å–∏—è ‚Äî —ç—Ç–æ "–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è" VM –≤ –ø–ª–∞–Ω–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –¥–∏—Å–ø–µ—Ç—á–µ—Ä —Å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–º, –ø–æ—Ö–æ–∂–∏–º –Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥ –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º. –í—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–æ–¥ VM, –Ω–µ—Ç —Ü–µ–ø–æ—á–∫–∏ –∫–ª—é—á–µ–π –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –æ–ø–∫–æ–¥—É, –æ–ø–µ—Ä–∞–Ω–¥—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –¥–∞–∂–µ –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã. –ò –µ—Å—Ç—å –≥–æ—Ä–∞–∑–¥–æ –º–µ–Ω—å—à–µ –º—É—Ç–∞—Ü–∏–π –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö. –§–∞–π–ª—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–µ–º–æ-–≤–µ—Ä—Å–∏–µ–π, –¥–∞–∂–µ –Ω–µ –º–æ–≥—É—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è POC VMP, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –∑–∞—â–∏—â–µ–Ω—ã –º–µ–Ω—å—à–µ, —á–µ–º –ø–ª–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è. –¢–∞–∫–∂–µ —Ü–µ–ø–æ—á–∫–∏ –∫–ª—é—á–µ–π –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –≤–µ—Ä—Å–∏—è—Ö 2.x (—Å–º–µ—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –±—ã–ª–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ "—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏"), VMP 2.x ‚Äî —ç—Ç–æ, –ø–æ —Å—É—Ç–∏, —Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–µ–º–æ-–≤–µ—Ä—Å–∏—è VMP 3.x —Å rolling key –Ω–∞ –æ–ø–µ—Ä–∞–Ω–¥–∞—Ö. –ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ–∞–ª—å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ VMP x86, —è –æ—Å–Ω–æ–≤—ã–≤–∞–ª —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –Ω–∞ –ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏, –±–ª–∞–≥–æ–¥–∞—Ä—è –æ–¥–Ω–æ–º—É –∏–∑ –º–æ–∏—Ö –¥—Ä—É–∑–µ–π, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–µ–ª–∏–ª—Å—è –ª–∏—Ü–µ–Ω–∑–∏–µ–π üß°.

## III - –ü–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥

–ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å —á–µ–≥–æ-—Ç–æ, —è –ø–æ–∫–∞–∂—É –≤–∞–º, —á—Ç–æ —Ç–∞–∫–æ–µ —Ä—É—Ç–∏–Ω–∞ VMP. –ü–µ—Ä–≤–æ–µ, —á—Ç–æ –º—ã –º–æ–∂–µ–º –∑–∞–º–µ—Ç–∏—Ç—å –ø—Ä–∏ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏, ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç `–ø–µ—Ä–µ—Ö–æ–¥` –≤ —Å–µ–∫—Ü–∏—é `.vmp0`.

–û—Å—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –±—ã–ª–∞ –∑–∞–º–µ–Ω–µ–Ω–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–¥–æ–º VMP (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞).

–ó–∞—Ç–µ–º –∫–æ–¥ –≤ —Å–µ–∫—Ü–∏–∏ VMP –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `push uint32` –∏ `call function`. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä—É—Ç–∏–Ω—ã VMP. –ò–Ω–æ–≥–¥–∞ —ç—Ç–æ "–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π—Å—è –≤—ã–∑–æ–≤", –∏ –¥–∞–Ω–Ω—ã–µ –∑–∞ –Ω–∏–º —Å–ª—É—á–∞–π–Ω—ã, –∏–Ω–æ–≥–¥–∞ —ç—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ `VENTER`.

–ó–Ω–∞—á–µ–Ω–∏–µ, –ø–æ–º–µ—â–µ–Ω–Ω–æ–µ –≤ —Å—Ç–µ–∫ (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `0xfe628c90`), ‚Äî —ç—Ç–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞—á–∞–ª–æ –æ–ø–∫–æ–¥–∞ (–Ω–∞—á–∞–ª–æ VIP, EP), –∞ –≤—ã–∑–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `VENTER`, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å—à–∏—Ñ—Ä—É–µ—Ç —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ (—ç—Ç–æ –Ω–µ–±–æ–ª—å—à–æ–π —Å–ø–æ–π–ª–µ—Ä, –≤—Å–µ –æ–±—ä—è—Å–Ω–µ–Ω–æ –Ω–∏–∂–µ). –î–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –º—ã –Ω–µ –∑–Ω–∞–µ–º, —á—Ç–æ —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (`VENTER`). –ï—Å–ª–∏ –º—ã –ø—Ä–æ–¥–æ–ª–∂–∏–º –≤ –≤—ã–∑–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –º—ã –ø–æ–ø–∞–¥–µ–º –≤ —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ—á–µ–≤–∏–¥–Ω–æ –º—É—Ç–∏—Ä–æ–≤–∞–Ω—ã (—Å–º.: –ß–∞—Å—Ç—å 2: –ú—É—Ç–∞—Ü–∏—è –∫–æ–¥–∞), –∏ —ç—Ç–æ—Ç –∫–æ–¥ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è `–ø–µ—Ä–µ—Ö–æ–¥–æ–º` –∫ –∞–¥—Ä–µ—Å—É –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ.

–ï—Å–ª–∏ –º—ã –ø—Ä–æ–¥–æ–ª–∂–∏–º –Ω–µ–º–Ω–æ–≥–æ, –º—ã –Ω–∞—á–Ω–µ–º –±—ã—Å—Ç—Ä–æ –∑–∞–º–µ—á–∞—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å. –ú—ã –∑–∞–º–µ—á–∞–µ–º, —á—Ç–æ —ç—Ç–∏ "–±–ª–æ–∫–∏" (–∫–æ–¥, –∑–∞ –∫–æ—Ç–æ—Ä—ã–º —Å–ª–µ–¥—É–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É –¥—Ä—É–≥ –∑–∞ –¥—Ä—É–≥–æ–º. –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, —è —Ä–∞–∑–¥–µ–ª–∏–ª –∫–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö "–±–ª–æ–∫–æ–≤" –∏ –ø–µ—Ä–µ—á–∏—Å–ª–∏–ª –∏—Ö. –í–æ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –Ω–∞—á–∞–ª–æ –±–ª–æ–∫–∞).

–ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –Ø —É–¥–∞–ª–∏–ª —á–∞—Å—Ç–∏ –º—É—Å–æ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞, —á—Ç–æ–±—ã —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É.

## IV - –î–∞–≤–∞–π—Ç–µ —Ä–µ–≤–µ—Ä—Å–∏—Ç—å

–ò—Ç–∞–∫, –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –æ–¥–∏–Ω –∏–∑ —ç—Ç–∏—Ö –±–ª–æ–∫–æ–≤ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞. –ö–∞–∫ –≤—ã, –≤–æ–∑–º–æ–∂–Ω–æ, –¥–æ–≥–∞–¥–∞–ª–∏—Å—å, —ç—Ç–∏ –±–ª–æ–∫–∏ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —è–≤–ª—è—é—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ VM (–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏).

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ (—Å –º—É—Ç–∞—Ü–∏–µ–π –∫–æ–¥–∞):

–ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å, –º—É—Ç–∞—Ü–∏—è –∫–æ–¥–∞ –¥–æ–≤–æ–ª—å–Ω–æ —Å–∏–ª—å–Ω–∞—è, –ø–æ—ç—Ç–æ–º—É –¥–∞–≤–∞–π—Ç–µ —É–¥–∞–ª–∏–º –µ–µ. –í–æ—Ç —Ç–∞ –∂–µ –≤–µ—Ä—Å–∏—è, –Ω–æ –±–µ–∑ –º—É—Å–æ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞:

–•–æ—Ä–æ—à–æ, —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç:

–ò—Ç–∞–∫, —ç—Ç–æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `VPUSH16 [VCTX + *]`!

## V - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ VM

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ —Ç–∞–∫–æ–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –≤–æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ VM.

## V.1 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

VM —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

–û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π `VIP`, —Ö—Ä–∞–Ω—è—â–∏–π—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ x86, –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å —Å—Ç–µ–∫–∞ `VSP`, —Ç–∞–∫–∂–µ —Ö—Ä–∞–Ω—è—â–∏–π—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ x86. –í –∫–∞–∂–¥–æ–π —Ä—É—Ç–∏–Ω–µ VMP –æ–Ω–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å–ª—É—á–∞–π–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç VMP 2.X, –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω—ã, –µ—Å–ª–∏ —Ä—É—Ç–∏–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ (—Å–º. —á–∞—Å—Ç–∏ –Ω–∏–∂–µ).

VM –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º `VCTX`, –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—Å—Ç—å 18 —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ `R0 -> R17` –∏ —Å—Ç–µ–∫. –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–µ—Ä–∞–Ω–¥ rolling key –≤ `esp + 0x60`, –∞ —Å–∞–º rolling key —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–ª—É—á–∞–π–Ω–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ x86. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Å–º–µ—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ (–±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ + —Å–º–µ—â–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏) —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ.

–ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –µ—Å–ª–∏ –≤—ã –≤–∫–ª—é—á–∏—Ç–µ –ø–∞–∫–æ–≤—â–∏–∫ VMProtect, `.vmp1` —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ VMP –∏ –º—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤—Å–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `.vmp0`.

## V.2 - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

–ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ ~20 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, ~40, –µ—Å–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä (—ç—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —è –Ω–µ —Ä–µ–≤–µ—Ä—Å–∏–ª), –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π: –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–º–µ—â–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏ –µ–≥–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (–æ–ø–µ—Ä–∞–Ω–¥–æ–≤) (–∫–∞–∂–¥—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∏–ª—å–Ω–æ –º—É—Ç–∏—Ä–æ–≤–∞–Ω).

–Ø –Ω–µ –±—É–¥—É –æ–±—ä—è—Å–Ω—è—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–¥—Ä–æ–±–Ω–æ, –Ω–æ –≤–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö:

```
VENTER, VEXIT, VADDU*, VNANDU*, VNORU*, VPUSHV, VPOPR, VPOPVSP, VPUSHVSP, VPUSHI*
VFETCH*, VJUMP_*, VMOV*, VSHLU*, VSHRU*, VMULU*, VDIVU*, ....
```

–†—É—Ç–∏–Ω–∞ VMP –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ VENTER –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π VEXIT. –ö–æ–≥–¥–∞ VMP –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é x86, –æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å –≤ —Ä—É—Ç–∏–Ω–µ VM, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä—ã VMP (—Å–º.: `V.4 - –ü–æ—Ç–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è`).

## V.3 - Rolling key

## V.3.1 - –ü–æ—Ç–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

VMP —Å–∏–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–ª—Å—è —Å –≤–µ—Ä—Å–∏–∏ 2.x –≤ —ç—Ç–æ–º –æ—Ç–Ω–æ—à–µ–Ω–∏–∏. –†–∞–Ω—å—à–µ –æ–ø–∫–æ–¥ –∏–∑–≤–ª–µ–∫–∞–ª—Å—è —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –≤ –º–∞—Å—Å–∏–≤–µ —Å –ø–µ—Ä–µ—Ö–æ–¥–æ–º —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–ø–∫–æ–¥–∞ –≤ –º–∞—Å—Å–∏–≤–µ. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ –≤—Å–µ –µ—â–µ —Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏ VMP. –í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è —Ç–∞–±–ª–∏—Ü–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å, –Ω–æ –ø–æ—Ç–æ–∫ –±–æ–ª—å—à–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è "–ª–∏–Ω–µ–π–Ω—ã–º" (–∏–Ω–¥–µ–∫—Å —á–µ—Ä–µ–∑ –º–∞—Å—Å–∏–≤).

–í–æ–∑—å–º–µ–º –ø—Ä–∏–º–µ—Ä: —Ç–µ–∫—É—â–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–ø–∫–æ–¥–∞ (—Å–ª–µ–¥—É—é—â–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è) —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º "rolling" –∫–ª—é—á–æ–º –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –º—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä—É—Ç–∏–Ω–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏. Rolling –æ–∑–Ω–∞—á–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É –∫–ª—é—á–µ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–π –æ–ø–∫–æ–¥ —Å–≤–æ–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º –≤ `edi`. –í–æ –≤—Ä–µ–º—è —Ä—É—Ç–∏–Ω—ã —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∫–ª—é—á –≤ `edi` –±—ã–ª —É–Ω–∏–∫–∞–ª—å–Ω–æ –º—É—Ç–∏—Ä–æ–≤–∞–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä—É—Ç–∏–Ω—ã —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏, —á—Ç–æ–±—ã –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–º—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –æ–ø–∫–æ–¥.

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, –≤–æ-–ø–µ—Ä–≤—ã—Ö, —á—Ç–æ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –æ–ø–∫–æ–¥–æ–≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏–º–≤–æ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–∫–∞–∫ NoVmp —Å VTIL), –∏ –≤—ã —Ç–∞–∫–∂–µ –æ–±—è–∑–∞–Ω—ã –ø—Ä–æ–π—Ç–∏ –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–ø–∫–æ–¥. –ù–æ —ç—Ç–æ —Ç–∞–∫–∂–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–∏–ª–∏ —ç—Ç–æ –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ), –ø–æ—Ç–æ–º—É —á—Ç–æ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –≤—ã –¥–æ–ª–∂–Ω—ã —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –µ–µ –∫–ª—é—á —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–µ –∫–ª—é—á–µ–π (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è).

–≠—Ç–æ –ø—Ä–∏–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è VIP –≤ –∫–æ–Ω—Ü–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞:

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –æ–ø–µ—Ä–∞–Ω–¥ rolling key ‚Äî —ç—Ç–æ —Å–º–µ—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `edx` –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ), –∞ rolling key —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `ebx`.

–ü–†–ò–ú–ï–ß–ê–ù–ò–ï: VMP 3.x x64, —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –≤—Å–µ –µ—â–µ —Ö—Ä–∞–Ω–∏—Ç —Ç–∞–±–ª–∏—Ü—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ, –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –Ω–µ–º—É, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç —ç—Ç–æ–≥–æ, –≥–¥–µ —Å–º–µ—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è.

## V.3.2 - –û–ø–µ—Ä–∞–Ω–¥—ã

–ö–∞–∫ –∏ –≤ VMP 2.x, rolling key —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–µ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ä—É—Ç–∏–Ω—ã —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ `V.3.1 - –ü–æ—Ç–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π`, –æ–ø–µ—Ä–∞–Ω–¥ rolling key ‚Äî —ç—Ç–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –Ω–æ rolling key —Ç–∞–∫–æ–π –∂–µ, –∫–∞–∫ –≤ `V.3.1 - –ü–æ—Ç–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π`.

## V.4 - –ü–æ—Ç–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ò—Ç–∞–∫, –∫–∞–∫ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å –≤—ã—à–µ, –ø–æ—Ç–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ rolling key (—Å–º.: `V.3.1 - –ü–æ—Ç–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π`), –∏ —Ä—É—Ç–∏–Ω–∞ VMP –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `VENTER`. –û–¥–Ω–∞–∫–æ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∂–¥—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é x86, –∫–∞–∫ —è –≥–æ–≤–æ—Ä–∏–ª –≤ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–µ–º –ø–æ—Å—Ç–µ, –ø–æ—ç—Ç–æ–º—É VMP —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ –∫–æ–¥–µ. –í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä—É—Ç–∏–Ω—ã VM –≤—ã–ø–æ–ª–Ω–∏—Ç `VEXIT`, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç x86 –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é. –ò —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è VENTER, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç VM.

–í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: `MOVDQ2Q, STOS*, FSINCOS, WBINVD, WRMSR, UD2 (–∫–æ–Ω–µ—á–Ω–æ), MOVNTPD, CPUID ...`

–≠—Ç–æ—Ç –ø—Ä–æ–ø—É—Å–∫ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º —Ü–∏–∫–ª–∞–º (—Å–º. –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ VMP –∫–∞–∫ —Ö–æ—Ä–æ—à–∏–π –ø—Ä–∏–º–µ—Ä).

–í—ã–∑–æ–≤ API —Ç–∞–∫–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–Ω–µ VMP. –ü–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π `VEXIT` –∏–∑–≤–ª–µ—á–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ x86. –ò —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –µ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –æ –≤—ã–∑–æ–≤–∞—Ö.

–í —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —è –≤–∏–¥–µ–ª –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é VMP, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–∏–∫–ª –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é, –±–µ–∑ `VEXIT`. –ù–æ —ç—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —è –º–æ–≥ –≥–æ–≤–æ—Ä–∏—Ç—å –æ–± —ç—Ç–æ–º –±–æ–ª—å—à–µ.

## V.5 - –û –º—É—Å–æ—Ä–Ω–æ–º –∫–æ–¥–µ

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –∑–Ω–∞–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ VMP, –º—ã –º–æ–∂–µ–º —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —ç—Ç–æ, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –±–æ–ª—å—à–µ –º—É—Å–æ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞. –ò—Ç–∞–∫, VMP –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö `cmp` / `test` –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö `VIP` –∏ `VSP`, —Ç–∞–∫ –∫–∞–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MBA (—Å–º. –Ω–∏–∂–µ). –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `mov`, `cmp` –∏ `xchg` –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ —Ä–µ–≥–∏—Å—Ç—Ä–µ, –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑–º–µ—Ä—ã —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `mov al, dl` –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç 32-–±–∏—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è). –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Ö–∞–Ω–∏–∑–º–µ –º—É—Ç–∞—Ü–∏–∏ –∫–æ–¥–∞ VMP –∏ –µ–≥–æ –º—É—Å–æ—Ä–Ω–æ–º –∫–æ–¥–µ, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –º–æ–µ–π –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç–∞—Ç—å–µ–π –æ–± —ç—Ç–æ–º (–ß–∞—Å—Ç—å 2: –ú—É—Ç–∞—Ü–∏—è –∫–æ–¥–∞).

## VI - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–ò—Ç–∞–∫, –∫–∞–∫ —Å —ç—Ç–∏–º —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è? –£ –≤–∞—Å –µ—Å—Ç—å –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞: –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é –∏–ª–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø–∫–æ–¥—ã VMP. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ, —Ç–∞–∫ –∫–∞–∫ –≤–∞–º –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –æ–±—Ä–∞–∑—Ü–æ–º, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ VMP –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è. –î–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è, —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –¥–∞–µ—Ç –≤–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –∫–æ–¥ x86, –∫–æ—Ç–æ—Ä—ã–π –±–ª–∏–∑–æ–∫ –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É –∫–æ–¥—É –Ω–∞–ø—Ä—è–º—É—é. –ù–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –Ω–µ–º–Ω–æ–≥–æ –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å, —Ç–∞–∫ –∫–∞–∫ –≤–∞–º –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å –∏ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –ª—é–±–æ–º –≤–æ–∑–º–æ–∂–Ω–æ–º —Å–ª—É—á–∞–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IR –¥–ª—è –ø–æ–¥—ä–µ–º–∞ –∏ —É–ø—Ä–æ—â–µ–Ω–∏—è –∑–∞–ø—É—Ç–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞. –≠—Ç–∏ –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –ø–µ—Ä–≤—ã–π —Ç—Ä–µ–±—É–µ—Ç —ç–º—É–ª—è—Ü–∏–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ä—É—Ç–∏–Ω —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ rolling, –∞ –≤—Ç–æ—Ä–æ–π —Ç—Ä–µ–±—É–µ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ –∞—Å–ø–µ–∫—Ç–∞ VM (Triton, Miasm, ..). –Ø –∫—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–ª –ø–æ–¥—Ö–æ–¥ –∫ –¥–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ `IX - –î–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è`.

–¢–∞–∫ –∫–∞–∫ —è –Ω–µ —Ö–æ—á—É —Ç—Ä–∞—Ç–∏—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —ç—Ç–æ, —è —Å–¥–µ–ª–∞–ª –∫–æ—Ä–æ—Ç–∫–∏–π —Ç—Ä–µ–π—Å–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ qiling (–∏—Å–ø–æ–ª—å–∑—É—è —ç–º—É–ª—è—Ü–∏—é unicorn). –≠—Ç–æ—Ç "–æ—Ç–ª–∞–¥—á–∏–∫" –±—É–¥–µ—Ç —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Ä—É—Ç–∏–Ω –∏, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –æ–±—Ä–∞–∑—Ü–æ–º, –ø–æ–π–º–µ—Ç, –∫–∞–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è VMP –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (–±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ç–æ–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è).

## VII - –ü—Ä–∏–º–µ—Ä

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –º–æ–∂–µ–º —á–∏—Ç–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ VMP, –º—ã –º–æ–∂–µ–º –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–Ω—è—Ç—å –∫–æ–¥ –≤ VM. –í–æ—Ç –¥–≤–∞ –ø—Ä–∏–º–µ—Ä–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä—É—Ç–∏–Ω: –ø–µ—Ä–≤—ã–π ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–∞—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∞ –≤—Ç–æ—Ä–æ–π ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä if.

–ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –ö–æ–Ω–µ—á–Ω–æ, —ç—Ç–æ –ù–ï –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –≤–∑–ª–æ–º–∞—Ç—å VMP, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–∏ VM.

–ü–†–ò–ú–ï–ß–ê–ù–ò–ï 2: –ú–æ–π —Ç—Ä–µ–π—Å–µ—Ä –ø—Ä–æ–ø—É—Å—Ç–∏–ª —Ä—É—Ç–∏–Ω—ã —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏, –≤—Å–µ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∂–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã.

## VII.1 - –ü—Ä–æ—Å—Ç–∞—è —Ä—É—Ç–∏–Ω–∞

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä—É—Ç–∏–Ω–∞, –≤–æ—Ç –ø—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –∫–æ–¥–∞.

–í–æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥:

```c
int var_0 = 0x1337;

var_0 ^= 0x50;
var_0 *= 2;
var_0 -= 5;
var_0 += 0x80;

return var_0;
```

–í–æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–π –∫–æ–¥:

–ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å, —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –∏–∑-–∑–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è. –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ VMP —Ö—Ä–∞–Ω–∏—Ç —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

–ü–æ—Å–ª–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–¥ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ 126 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π VMP.

–ü–µ—Ä–≤–æ–µ, —á—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ VM, ‚Äî —ç—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ x86 –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö VMP (VENTER –ø–æ–º–µ—â–∞–µ—Ç –∫–∞–∂–¥—ã–π —Ä–µ–≥–∏—Å—Ç—Ä –≤ —Å—Ç–µ–∫ CPU).

–≠—Ç–æ—Ç –∫–æ–¥: `int var_0 = 0x1337;`

–≠—Ç–æ—Ç –∫–æ–¥: `var_0 ^= 0x50;`

–≠—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MBA (—Å–º.: –î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ MBA).

–í–æ—Ç –∫–æ–¥:

–≠—Ç–æ—Ç –∫–æ–¥: `var_0 *= 2;`

–≠—Ç–æ—Ç –∫–æ–¥: `var_0 -= 5;`

–≠—Ç–æ—Ç –∫–æ–¥: `var_0 += 0x80;`

–í –∫–æ–Ω—Ü–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä—É—Ç–∏–Ω–∞ –ø–æ–º–µ—â–∞–µ—Ç –∞–¥—Ä–µ—Å –≤–æ–∑–≤—Ä–∞—Ç–∞ (0x401043, –∞–¥—Ä–µ—Å `leave; retn`). –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç CPU –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –ø–æ–º–µ—â–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–µ–∫ VMP, –∏ VEXIT —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∫–∞–∂–¥—ã–π —Ä–µ–≥–∏—Å—Ç—Ä CPU –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–µ–∫–∞ VMP.

–í—Å–µ –µ—â–µ –∑–¥–µ—Å—å? –ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å, –º—ã –º–æ–∂–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–¥, –Ω–æ —ç—Ç–æ –Ω–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ :)

–í–æ—Ç –ø—Å–µ–≤–¥–æ–∫–æ–¥:

```c
int var_0 = 0x1337;

var_0 = ~(~(var_0) & ~(0x50)) & ~(~(~(var_0)) & ~(~(0x50)));
var_0 *= 2;
var_0 = ~(~(var_0) + 5);
var_0 += 0x80;

return var_0;
```

## VII.2 - –í–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–¢–µ–ø–µ—Ä—å, –∫–∞–∫ VMP –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Ç–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –≤–æ—Ç –ø—Ä–æ—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ if:

```c
int var_0 = 999;

if (var_0 == 999) {
    var_0 = 666;
} else {
    var_0 = 777;
}
```

–ï–≥–æ –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–π –∫–æ–¥:

–¢–µ–ø–µ—Ä—å –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥:

–ü–†–ò–ú–ï–ß–ê–ù–ò–ï: MBA —Å–ª–∏—à–∫–æ–º —Ç—è–∂–µ–ª—ã–π –≤ —ç—Ç–æ–π —á–∞—Å—Ç–∏, –ø–æ—ç—Ç–æ–º—É —è —Å—É–º–º–∏—Ä–æ–≤–∞–ª.

–°—Ä–∞–∑—É –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥ —Å –∑–∞–º–µ–Ω–æ–π:

–ò —ç—Ç–æ –∫–æ–¥, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–π –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞:

–ù—É –∏ —Å–Ω–æ–≤–∞, —Ç–∞–∫ –∫–∞–∫ —É—Å–ª–æ–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ —Ä–∞—Å–ø–ª–∞–≤–ª–µ–Ω–æ –≤ MBA, —ç—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ —Å–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø–æ–¥—ä–µ–º–∞.

## VIII - –¢—Ä—é–∫–∏, —á—Ç–æ–±—ã —É—Å–ª–æ–∂–Ω–∏—Ç—å –∑–∞–¥–∞—á—É

## VIII.1 - –í–Ω–µ –∫–æ–¥–∞ VMP

## VIII.1.1 - –í–∞—Ä–∏–∞–Ω—Ç—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ VMP –∏–º–µ—é—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Ü–µ–ª—å, –Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –≤ –ø–ª–∞–Ω–µ –∫–æ–¥–∞ (–Ω–µ –≤ –ø–ª–∞–Ω–µ –º—É—Ç–∞—Ü–∏–∏ –∫–æ–¥–∞). –í–æ—Ç –ø—Ä–∏–º–µ—Ä `VJUMP`, —ç—Ç–∏ –¥–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã, –Ω–æ –∏—Ö –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω–æ, –æ–¥–∏–Ω –∑–∞–º–µ–Ω—è–µ—Ç VIP –Ω–∞ VSP, –¥—Ä—É–≥–æ–π –ø–æ–º–µ—â–∞–µ—Ç VSP –≤ `edi`. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –µ—Å—Ç—å 4 —Ç–∞–∫–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ VMP, –∏ –æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

## VIII.1.2 - –í–∞—Ä–∏–∞–Ω—Ç—ã —Å–º–µ—â–µ–Ω–∏–π –æ–ø–µ—Ä–∞–Ω–¥–æ–≤

–í–æ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è push immediate –≤ –¥–≤—É—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö, —ç—Ç–∏ –¥–≤–∞ –∏–∑–≤–ª–µ–∫–∞—é—Ç imm —Å —Ä–∞–∑–Ω—ã–º–∏ —Å–º–µ—â–µ–Ω–∏—è–º–∏ –≤ –æ–ø–∫–æ–¥–µ. –ò–Ω–æ–≥–¥–∞ VIP —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ, –∞ –∏–Ω–æ–≥–¥–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ.

## VIII.1.3 - –ó–∞–º–µ–Ω–∞ VIP –∏ VSP

–ö–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ `VIII.1.1 - –í–∞—Ä–∏–∞–Ω—Ç—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π`, VMP —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∑–∞–º–µ–Ω—è–µ—Ç —Å–≤–æ–∏ —Ä–µ–≥–∏—Å—Ç—Ä—ã VIP –∏ VSP –≤–æ –≤—Ä–µ–º—è –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

## VIII.2 - –í–Ω—É—Ç—Ä–∏ –∫–æ–¥–∞ VMP

## VIII.2.1 - –ó–∞–º–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ VMP

–ö–∞–∫ –≤—ã –≤–∏–¥–µ–ª–∏ —Ä–∞–Ω–µ–µ, –∫–∞–∂–¥—ã–π –ø–µ—Ä–µ—Ö–æ–¥ "–∑–∞–º–µ–Ω—è–µ—Ç" –∫–∞–∂–¥—ã–π —Ä–µ–≥–∏—Å—Ç—Ä VMP, –∫–∞–∂–¥—ã–π —Ä–µ–≥–∏—Å—Ç—Ä –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ —Å—Ç–µ–∫ –∏ —Å—Ä–∞–∑—É –∂–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã. –ß—Ç–æ–±—ã —É—Å–ª–æ–∂–Ω–∏—Ç—å –ø–æ—Ç–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

## VIII.2.2 - MBA

VMP –ø–µ—Ä–µ–¥–∞–µ—Ç –≤—Å–µ —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ MBA, –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–¥–µ–ª–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ (`MBA_XOR_*(x,y) = (MBA_SUB_*(MBA_OR_V*(x,y), (MBA_AND_V*(x,y))))`). –í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö, –∫–æ—Ç–æ—Ä—ã–µ —è –Ω–∞—à–µ–ª –≤–æ –≤—Ä–µ–º—è —Å–≤–æ–µ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:

```c
x ^ y = (~(~(x) & ~(y)) & ~(~(~(x)) & ~(~(y))))
x ^ y = ((~(~(x)) & ~(~(y))) + (~(~(x)) | ~(~(y))))
x ^ y = ((~(~(y)) | ~(~(x))) + ~(~(x)) - (~(~(x)) & ~(~(~(y)))))
x ^ y = ((~(~(x)) | ~(~(y))) + (~(~(~(x))) | ~(~(y))) - (~(~(~(x)))))
x ^ y = ((~(~(x)) | ~(~(y))) + ~(~(y)) - (~(~(~(x))) & ~(~(y))))
x ^ y = (~(~(y)) + (~(~(x)) & ~(~(~(y)))) + (~(~(x)) & ~(~(y))))

x - y = (~(~(x) + y))
x - y = (~(((~(~(x)) | y) - (~(~(x))))))
x - y = (~((~(x) & ~(x)) + y) & ~((~(x) & ~(x)) + y))

x & y = ((~(~(x)) | y) - (~(~(~(x))) & y) - (~(~(x)) & ~y))
x & y = ((~(~(~(x))) | y) - (~(~(~(x)))))

x | y = ((~(~(x)) & ~(y)) + y)
x | y = (((~(~(x)) & ~(y)) & y) + ((~(~(x)) & ~(y)) | y))

x + y = ((~(~(x)) & ~(~(y))) + (~(~(x)) | ~(~(y))))
...
```

–ü–†–ò–ú–ï–ß–ê–ù–ò–ï: VMP, –ø–æ—Ö–æ–∂–µ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–æ–∂–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ (–±–µ–∑ MBA) –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤.

## VIII.2.3 - –°–ª—É—á–∞–π–Ω—ã–µ '–≤—ã–∑–æ–≤—ã'

–ò–Ω–æ–≥–¥–∞ —è –≤–∏–∂—É '–≤—ã–∑–æ–≤—ã' (VPUSHVSP, VPOPVSP) –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã, –∏ —è –Ω–µ –º–æ–≥—É –ø–æ–Ω—è—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–º –º—É—Å–æ—Ä–Ω—ã–º –∫–æ–¥–æ–º –∏–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–º –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å—Ç–µ–∫–æ–º.

## VIII.3 - –†–µ–∂–∏–º Ultra

–¢–µ–ø–µ—Ä—å –≤–æ–∑—å–º–µ–º —Ç–æ—Ç –∂–µ –ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä (–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π), –Ω–æ –≤ —Ä–µ–∂–∏–º–µ Ultra. –ù–∞—à –∫–æ–¥ —Ç–µ–ø–µ—Ä—å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ `20817` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ `428` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π VMP. –ó–¥–µ—Å—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∫–æ–¥–∞, —á—Ç–æ–±—ã –æ—Ö–≤–∞—Ç–∏—Ç—å, –ø–æ—ç—Ç–æ–º—É —è –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂—É, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ MBA –Ω–∞–º–Ω–æ–≥–æ —Ç—è–∂–µ–ª–µ–µ, –∏ –µ—Å—Ç—å –º–Ω–æ–≥–æ VJUMP (–∑–∞–º–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ + –∑–∞–º–µ–Ω–∞ VSP/VIP). –¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ –º—É—Ç–∏—Ä–æ–≤–∞–Ω, –ø–æ—ç—Ç–æ–º—É –æ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç –º–Ω–æ–≥–æ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≤ —Ä—É—Ç–∏–Ω—É.

## IX - –î–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è

–ò—Ç–∞–∫, –∫–∞–∫ –º—ã –º–æ–∂–µ–º —ç—Ç–æ –≤–∑–ª–æ–º–∞—Ç—å? –ù—É, –º—ã –º–æ–∂–µ–º –Ω–µ–º–Ω–æ–≥–æ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å –æ –ø–æ–¥—Ö–æ–¥–µ '–î–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è'.

## IX.1 - "–ú–µ–Ω–µ–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±": —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –æ–±—Ä–∞–∑—Ü–æ–º

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ç–æ–¥ ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è x86 –∫–∞–∫–∏–º-–ª–∏–±–æ –æ–±—Ä–∞–∑–æ–º (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏) ‚Äî —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–æ–π –±–ª–æ–∫ —è–≤–ª—è–µ—Ç—Å—è –∫–∞–∫–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π VMP —Å –ø–æ–º–æ—â—å—é —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å –æ–±—Ä–∞–∑—Ü–æ–º (–∫–∞–∫ —è —Å–¥–µ–ª–∞–ª, –Ω–æ –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤ –ø–æ—Ç–æ–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è). –ò –∫–∞–∫ —Ç–æ–ª—å–∫–æ —ç—Ç–æ —Å–¥–µ–ª–∞–Ω–æ, –≤—ã –º–æ–∂–µ—Ç–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ –¥—Ä—É–≥–æ–π —è–∑—ã–∫, —Ç–∞–∫–æ–π –∫–∞–∫ x86. –ù–æ –∫–æ–¥ –±—É–¥–µ—Ç —É–∂–∞—Å–Ω—ã–º –∏–∑-–∑–∞ MBA –∏ –∑–∞–º–µ–Ω—ã —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤, –ø–æ—ç—Ç–æ–º—É –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ —è–∑—ã–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ (LLVM, VTIL –∫–∞–∫ –≤ NoVMP). –û—Ç—Å—é–¥–∞ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–¥—ä–µ–º –∫–æ–¥–∞/–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –º—É—Å–æ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞, MBA –∏ –¥—Ä—É–≥–∏—Ö –∑–∞–ø—É—Ç—ã–≤–∞–Ω–∏–π, –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ x86. –ü—Ä–æ—Ö–æ–¥—ã LLVM –±—ã–ª–∏ —Å–¥–µ–ª–∞–Ω—ã –≤ –ø—Ä–æ—à–ª–æ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏, –∏ –º–Ω–æ–≥–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É–ø—Ä–æ—â–∞—é—Ç –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –≤ LLVM IR.

–ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ö–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ LLVM –¥–ª—è –ø–æ–¥—ä–µ–º–∞ –≤–∞—à–µ–≥–æ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ä—É—Ç–∏–Ω–∞, –º–æ–π –¥—Ä—É–≥ IDontCode —Å–¥–µ–ª–∞–ª —ç—Ç–æ –¥–ª—è –¥–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ VMP 2.x (–∑–¥–µ—Å—å) —Å –æ—Ç–ª–∏—á–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (–º–µ–Ω—å—à–µ MBA –≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏, —Ö–æ—Ç—è).

–ß—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è MBA, –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ä—É—Ç–∏–Ω—É –≤ SMT –∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –µ–≥–æ, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å, –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç Mrphrazer (—Å–º.: –§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –∫–æ–¥–∞ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö –±—É–ª–µ–≤–æ-–∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π). –í—ã –¥–∞–∂–µ –º–æ–∂–µ—Ç–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ IR –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏—è SSA, —á—Ç–æ–±—ã —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∏—Ö —Å –ø–æ–º–æ—â—å—é Miasm –∏–ª–∏ Triton (—Ö–æ—Ä–æ—à–∏–π –ø—Ä–∏–º–µ—Ä –∑–¥–µ—Å—å –æ—Ç mrt4ntr4). –î–∞–∂–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä LLVM –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º Souper, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π Google, —Ä–µ–∞–ª–∏–∑—É–µ—Ç SMT-—Å–∏–º–ø–ª–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ LLVM IR.

–ü—Ä–æ—Å—Ç–æ —á—Ç–æ–±—ã —É–ø–æ–º—è–Ω—É—Ç—å, Fvrmatteo –¥–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª VMP, –∏—Å–ø–æ–ª—å–∑—É—è —à–∞–±–ª–æ–Ω—ã C++ –¥–ª—è LLVM IR, –∏ –Ω–∞–ø–∏—Å–∞–ª –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–µ —Å—Ç–∞—Ç—å–∏ –æ —Ç–æ–º, –∫–∞–∫ –æ–Ω –ø–æ–¥–Ω–∏–º–∞–ª —Ä—É—Ç–∏–Ω—ã LLVM (–©–µ–∫–æ—Ç–∫–∞ VMProtect —Å LLVM). –ï–≥–æ –ø—Ä–æ—Ö–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ LLVM –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ø—Ä–æ—â–µ–Ω–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö LLVM. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –º–æ—â–Ω—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –¥–ª—è –ø–æ–¥—ä–µ–º–∞ –∑–∞–ø—É—Ç–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLVM IR, —Ç–∞–∫–∏–µ –∫–∞–∫ SATURN (–∑–¥–µ—Å—å).

## IX.2 - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: DTA & –°–∏–º–≤–æ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

–ì–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π —Å–ø–æ—Å–æ–±... –∏—Å–ø–æ–ª—å–∑—É—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è –∏–ª–∏ —Å–∏–º–≤–æ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, —Ü–µ–ª—å –±—É–¥–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫ VM –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–≤–æ–∏ —Ä–µ–≥–∏—Å—Ç—Ä—ã, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ –¥–µ–ª–∞–µ—Ç VM. –ö–æ—Ä–æ—á–µ –≥–æ–≤–æ—Ä—è, –ø–æ–Ω—è—Ç—å –∫–æ–¥ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ VM, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —á—Ç–æ –∏ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥. –≠—Ç–æ –Ω–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ, –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥—É–º–∞—Ç—å, –µ—Å—Ç—å –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞—Ç—å—è –î–∂–æ–Ω–∞—Ç–∞–Ω–∞ –°–∞–ª–≤–∞–Ω–∞, –°–µ–±–∞—Å—Ç—å–µ–Ω–∞ –ë–∞—Ä–¥–µ–Ω–∞ –∏ –ú–∞—Ä–∏-–õ–æ—Ä –ü–æ—Ç–µ—Ç –æ–± —ç—Ç–æ–π –∑–∞–¥–∞—á–µ: –°–∏–º–≤–æ–ª—å–Ω–∞—è –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è: –æ—Ç –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –æ–±—Ä–∞—Ç–Ω–æ –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—É.

–í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:

* –î–∂–æ–Ω–∞—Ç–∞–Ω –°–∞–ª–≤–∞–Ω —Å–¥–µ–ª–∞–ª —Å–∫—Ä–∏–ø—Ç (–∑–¥–µ—Å—å) –æ VM Tigress –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –µ–≥–æ —Ä—É—Ç–∏–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏–º–≤–æ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –° —Å–∏–º–≤–æ–ª—å–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ Triton, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–º–∏ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ä—É—Ç–∏–Ω—É, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–∏–º–ø–ª–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º Arybo, —á—Ç–æ–±—ã –æ—á–µ–Ω—å –ª–µ–≥–∫–æ —É–¥–∞–ª–∏—Ç—å MBA VMP –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ LLVM IR.
* –ï—â–µ –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è –Ω–∞ —Ä—É—Ç–∏–Ω–µ VMP (UniTaint). –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è —ç–º—É–ª—è—Ü–∏–∏ –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è, –∞ –∑–∞—Ç–µ–º –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –∫–æ–¥ C, –ø—Ä–µ–∂–¥–µ —á–µ–º –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω—ã —á–µ—Ä–µ–∑ clang —Å –ø—Ä–æ—Ö–æ–¥–∞–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥–Ω—è—Ç—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≤—ã–≤–æ–¥.
* Mrexodia –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª –ø—Ä–∏–º–µ—Ä —É–ø—Ä–æ—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–∏–º–≤–æ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ VMP —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–≤–∏–∂–∫–∞ Triton (VMProtectTest).

## X - –û —Å–∫–æ—Ä–æ—Å—Ç–∏

–ò–∑ –º–æ–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ xor –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ ~40 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π VMP (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–º–µ—à–∞–Ω–∞ —Å –æ–±—Ñ—É—Å–∫–∞—Ü–∏–µ–π, –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ xor –Ω–µ —É—Ö–æ–¥–∏—Ç 50 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π). –ò —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º—É—Ç–∏—Ä–æ–≤–∞–Ω—ã (—è–¥—Ä–æ + —Ä–∞—Å—á–µ—Ç —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–ø–∫–æ–¥–∞), –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –æ–ø–∫–æ–¥ VMP –º–æ–∂–µ—Ç –±—ã—Ç—å –µ—â–µ –±–æ–ª—å—à–µ –∑–∞–ø—É—Ç–∞–Ω –≤ —Ä–µ–∂–∏–º–µ Ultra. –†—É—Ç–∏–Ω–∞ VMP –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é ~2000 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –¥–ª—è –æ–¥–Ω–æ–≥–æ xor (–≤–æ–∑—å–º–∏—Ç–µ —ç—Ç–æ —Å –¥–æ–ª–µ–π —Å–∫–µ–ø—Ç–∏—Ü–∏–∑–º–∞, —ç—Ç–æ –º–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–≤–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–æ–≥–æ, —á—Ç–æ —è –≤–∏–¥–µ–ª).

–í –º–æ–µ–º –ø—Ä–∏–º–µ—Ä–µ 17 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –±—ã–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ 5943 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –æ–∫–æ–ª–æ 126 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π VMP. –ê –≤ —Ä–µ–∂–∏–º–µ Ultra –æ–Ω–∏ –±—ã–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ 20817 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ 428 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π VMP. –Ø –ø—ã—Ç–∞–ª—Å—è –∏–∑–º–µ—Ä–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –≤–æ –≤—Ä–µ–º–µ–Ω–∏, –Ω–æ —ç—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–Ω–æ–≥–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç–∏–ø/–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–¥—Ä–∞/—Ä–µ—Å—É—Ä—Å–æ–≤, –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã... –ü–æ—ç—Ç–æ–º—É —è –æ—Å—Ç–∞–Ω—É—Å—å –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.

–°–æ–≥–ª–∞—Å–Ω–æ `throwawaycracker`, D***** –±—ã–ª –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ –≤ 2015 –≥–æ–¥—É: `"–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è x86 –±—É–¥–µ—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ 2 –¥–æ 50 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π VM"`. –ò —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è D***** –≤ —Ç–æ –≤—Ä–µ–º—è –±—ã–ª–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ VMP (–æ—á–µ–Ω—å –±–ª–∏–∑–∫–æ –∫ –Ω–µ–º—É), —è –¥—É–º–∞—é, —á—Ç–æ –º–æ–π –∞–Ω–∞–ª–∏–∑ –±–ª–∏–∑–æ–∫ –∫ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏.

## XI - –ß—Ç–æ –Ω–∞–º –¥–µ–ª–∞—Ç—å —Ç–µ–ø–µ—Ä—å?

–ò—Ç–∞–∫, —è —Å–¥–µ–ª–∞–ª –¥–ª—è —ç—Ç–æ–≥–æ –æ—Ç–ª–∞–¥—á–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ qilling. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, qiling –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–∑–æ–≤—ã API, –∏—Ö –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å (–ø–æ–Ω—è—Ç–Ω–æ). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —É –º–µ–Ω—è –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏: –ø–µ—Ä–≤–∞—è ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ –ª–µ–≥–∫–æ–º—É –ø—É—Ç–∏ (–≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è), –Ω–∞–ø–∏—Å–∞–≤ –∏–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–≤ —ç–º—É–ª—è—Ç–æ—Ä x86 –¥–ª—è PE, –∫–æ—Ç–æ—Ä—ã–π –º–æ–≥ –±—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—ã–∑–æ–≤—ã API (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'unicorn_pe', –Ω–æ –¥–ª—è x86). –í—Ç–æ—Ä–∞—è ‚Äî –Ω–∞–ø–∏—Å–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–∫–∞–∫ –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å NoVmp) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç–º—É–ª—è—Ü–∏–∏ —á–µ—Ä–µ–∑ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ unicorn. –ù–æ –æ–±–∞ —ç—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ç—Ä–µ–±—É—é—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∏ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è —É –º–µ–Ω—è –Ω–µ—Ç –Ω–∞ —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —è –ø—Ä–æ–¥–æ–ª–∂—É —Ä–∞–±–æ—Ç—É —Å –º–æ–∏–º –æ—Ç–ª–∞–¥—á–∏–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É –¥–æ–≤–æ–ª—å–Ω–æ —Ö–æ—Ä–æ—à–æ, –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é –æ–ø–∫–æ–¥ VMP –≤ —Ä—É—Ç–∏–Ω—É LLVM —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –ø—Ä–æ—Ö–æ–¥–∞–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –ò —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é LLVM IR –≤ x86 –≤ –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ.

## XII - –ó–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ

–ù—É, —è –¥—É–º–∞—é, —á—Ç–æ –º—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏! –Ø –Ω–µ —Ö–æ—á—É –≤—ã–ø—É—Å–∫–∞—Ç—å —Å–≤–æ–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ –æ—á–µ–≤–∏–¥–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º, —è –Ω–µ —Ö–æ—á—É, —á—Ç–æ–±—ã –º–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –±—ã–ª –≤–æ–≤–ª–µ—á–µ–Ω –≤ –ø–∏—Ä–∞—Ç—Å–∫–∏–µ –¥–µ–ª–∞. –ù–æ –ª—é–¥–∏ —É–∂–µ –ø–æ–¥–µ–ª–∏–ª–∏—Å—å —Ç–∞–∫–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤–µ—â–µ–π –≤–æ–∫—Ä—É–≥ VMP 2.x –≤ –ø—Ä–æ—à–ª–æ–º, –∏, –∫–æ–Ω–µ—á–Ω–æ, NoVmp –¥–ª—è VMP 3.x x64 —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω –∏ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, —Ç–∞–∫ —á—Ç–æ —ç—Ç–æ –Ω–µ –±–æ–ª—å—à–∞—è –ø—Ä–æ–±–ª–µ–º–∞. –í–æ–∑–º–æ–∂–Ω–æ, –µ—Å–ª–∏ –≤—ã–π–¥–µ—Ç –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä 4.x, –≤–æ–∑–º–æ–∂–Ω–æ, —è –≤—ã–ø—É—â—É —Å–≤–æ–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.

VMP –≤–µ–ª–∏–∫–æ–ª–µ–ø–µ–Ω —Å –º–æ–µ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π —à–∞–≥ –≤ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –ø–ª–∞–Ω–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ Themida, –Ω–∞–ø—Ä–∏–º–µ—Ä.

## ~r0da